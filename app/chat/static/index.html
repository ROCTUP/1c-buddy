<!doctype html>
<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <title>–ß–∞—Ç —Å 1–°:–ù–∞–ø–∞—Ä–Ω–∏–∫</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/png" href="/chat/static/buddy_small.png">
    <link href="/chat/static/styles.css" rel="stylesheet" />
  </head>
  <body>
    <div class="app-container">
      <!-- Sidebar with conversations list -->
      <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
          <button id="toggle-sidebar-btn" class="toggle-sidebar-btn" title="–°–≤–µ—Ä–Ω—É—Ç—å/—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å">‚óÄ</button>
          <h2>–ë–µ—Å–µ–¥—ã</h2>
          <button id="new-conversation-btn" class="new-conversation-btn" title="–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –±–µ—Å–µ–¥—É">‚ûï</button>
        </div>
        <div class="conversations-list" id="conversations-list">
          <!-- Conversations will be rendered here -->
        </div>
        <div class="sidebar-footer">
          <button id="clear-all-conversations-btn" class="clear-all-btn" title="–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –±–µ—Å–µ–¥—ã">
            üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –±–µ—Å–µ–¥—ã
          </button>
        </div>
      </aside>

      <!-- Main chat area -->
      <div class="main-area">
        <header class="topbar">
          <div class="brand">
            <button id="mobile-toggle-sidebar" class="mobile-toggle-btn" title="–ü–æ–∫–∞–∑–∞—Ç—å –±–µ—Å–µ–¥—ã">‚ò∞</button>
            <button id="desktop-toggle-sidebar" class="desktop-toggle-btn" title="–ü–æ–∫–∞–∑–∞—Ç—å –±–µ—Å–µ–¥—ã">‚ñ∂</button>
            <img src="/chat/static/buddy_small.png" alt="logo" class="logo" />
            <h1>–ß–∞—Ç —Å 1–°:–ù–∞–ø–∞—Ä–Ω–∏–∫</h1>
          </div>
          <div class="controls">
            <button id="search-btn" title="–ü–æ–∏—Å–∫ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏">üîç</button>
            <button id="export-btn" title="–≠–∫—Å–ø–æ—Ä—Ç –∏—Å—Ç–æ—Ä–∏–∏">üì•</button>
            <button id="clear-chat-btn" title="–û—á–∏—Å—Ç–∏—Ç—å –¥–∏–∞–ª–æ–≥">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
          </div>
        </header>

        <div class="search-container" id="search-container">
          <input type="text" id="search-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ —Å–æ–æ–±—â–µ–Ω–∏—è–º..." />
          <span class="search-results" id="search-results"></span>
          <button id="close-search-btn" title="–ó–∞–∫—Ä—ã—Ç—å –ø–æ–∏—Å–∫">‚úï</button>
        </div>

        <main>
          <section id="chat" class="chat"></section>

          <form id="send-form" class="composer">
            <div id="attached-files" class="attached-files"></div>
            <div class="input-wrapper">
              <input type="file" id="file-input" accept=".bsl,.xml,.txt" multiple style="display: none;" />
              <button id="attach-btn" type="button" title="–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª—ã (.bsl, .xml, .txt)" class="attach-btn-left">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path>
                </svg>
              </button>
              <textarea id="message-input" rows="1" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."></textarea>
              <button id="send-stop-btn" type="submit" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å" class="send-btn-circle">
                <svg class="send-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M12 19V5M5 12l7-7 7 7"/>
                </svg>
                <svg class="stop-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display:none;">
                  <rect x="6" y="6" width="12" height="12" rx="2"/>
                </svg>
              </button>
            </div>
          </form>

          <!-- Format menu for code blocks -->
          <div id="format-menu" class="format-menu hidden">
            <button data-format="1c" class="format-btn" title="–û—Ñ–æ—Ä–º–∏—Ç—å –∫–∞–∫ –∫–æ–¥ 1–° (Ctrl+Shift+1)">
              <span class="format-icon">üìù</span>
              –ö–æ–¥ 1–°
            </button>
            <button data-format="xml" class="format-btn" title="–û—Ñ–æ—Ä–º–∏—Ç—å –∫–∞–∫ XML (Ctrl+Shift+X)">
              <span class="format-icon">üè∑Ô∏è</span>
              XML
            </button>
          </div>
        </main>

        <footer class="statusbar">
          <span id="status">–ì–æ—Ç–æ–≤–æ</span>
          <div class="statusbar-right">
            <span id="tokens-label">–¢–æ–∫–µ–Ω—ã: <span id="total-tokens"><span class="token-arrow">‚Üë</span> 0 <span class="token-arrow">‚Üì</span> 0 <span class="token-total">(0)</span></span></span>
            <span id="session-label">–°–µ—Å—Å–∏—è: <code id="session-id">‚Äî</code></span>
          </div>
        </footer>
      </div>

      <!-- File Viewer Panel (right sidebar) -->
      <aside class="file-viewer-panel" id="file-viewer-panel">
        <div class="file-viewer-header">
          <div class="file-viewer-title">
            <span class="file-viewer-icon">üëÅ</span>
            <h3 id="file-viewer-filename">–ü—Ä–æ—Å–º–æ—Ç—Ä —Ñ–∞–π–ª–∞</h3>
          </div>
          <button id="close-file-viewer-btn" class="close-file-viewer-btn" title="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
        </div>
        <div class="file-viewer-toolbar">
          <button id="copy-file-content-btn" class="file-viewer-btn" title="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ">
            üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
          </button>
          <button id="download-file-btn" class="file-viewer-btn" title="–°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª">
            ‚¨á –°–∫–∞—á–∞—Ç—å
          </button>
          <button id="collapse-all-btn" class="file-viewer-btn" title="–°–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ –±–ª–æ–∫–∏" style="display: none;">
            ‚äü –°–≤–µ—Ä–Ω—É—Ç—å –≤—Å—ë
          </button>
          <button id="expand-all-btn" class="file-viewer-btn" title="–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ –±–ª–æ–∫–∏" style="display: none;">
            ‚äû –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤—Å—ë
          </button>
          <button id="search-file-btn" class="file-viewer-btn" title="–ü–æ–∏—Å–∫ –ø–æ —Ñ–∞–π–ª—É">
            üîç –ü–æ–∏—Å–∫
          </button>
          <span class="file-viewer-size" id="file-viewer-size"></span>
        </div>
        <div class="file-search-container" id="file-search-container">
          <input type="text" id="file-search-input" placeholder="–ü–æ–∏—Å–∫ –≤ —Ñ–∞–π–ª–µ..." autocomplete="off" />
          <span class="file-search-results" id="file-search-results"></span>
          <span class="file-search-spinner" id="file-search-spinner">‚è≥</span>
          <button id="file-search-prev-btn" class="file-search-nav-btn" title="–ü—Ä–µ–¥—ã–¥—É—â–∏–π (Shift+Enter)">‚¨Ü</button>
          <button id="file-search-next-btn" class="file-search-nav-btn" title="–°–ª–µ–¥—É—é—â–∏–π (Enter)">‚¨á</button>
          <button id="close-file-search-btn" class="file-search-close-btn" title="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
        </div>
        <div class="file-viewer-content" id="file-viewer-content">
          <div class="file-viewer-placeholder">
            <span class="placeholder-icon">üìÑ</span>
            <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞</p>
          </div>
        </div>
      </aside>
    </div>

    <script src="/chat/static/conversations.js"></script>
    <script src="/chat/static/markdown.js"></script>
    <script src="/chat/static/bsl.js"></script>
    <script src="/chat/static/xml.js"></script>
    <script src="/chat/static/code-folding.js"></script>
    <script src="/chat/static/mermaid.min.js"></script>
    <script src="/chat/static/dom-to-image-more.min.js"></script>
    <script src="/chat/static/app.js"></script>
  </body>
</html>